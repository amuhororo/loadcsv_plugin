# ティラノスクリプト用「CSV読込プラグイン」

csvファイルを任意のティラノ変数へ格納するプラグインです。  
テスト版  
  
※リリース時に色々変更の可能性があります。  
※もし要望などあればIssues等ででもおしらせください。  

## 使い方
1. `csv_test` フォルダを `data/other/pluin/` へ入れる。
2. csvファイルは `data/other/pluin/csv_test/` へ入れる。
3. first.ks 等でプラグインを読み込む。 `[plugin name="csv_test"]`
4. `[mc_loadcsv]`タグでcsvファイルを読み込む。  
`[mc_loadcsv file=sample.csv varname="tf.s.test" format=ObjectO split="_EOF" br=""]`

## パラメーター

| 属性名 | 必須 | 説明 |
----|----|----  
| file | 〇 | csvファイル名（拡張子必要） |
| varname | 〇 | 保存先変数名（f.hofe など） exp の方が解りやすいのかな？ |
| format | × | 配列パターンを指定します。（array/arrayA/arrayO/object/objectA/objectO) <br> ※指定が無ければ arrayA（多次元配列）になります。 |
| split | × | 分割用文字列を指定します（文字列： \_eof など）<br> ※指定が無ければ改行コードで分割します |
| br | × | 改行コードを変換する（文字列：\<br\> など）<br> ※split指定必須 |
| join | × | csvを追記する場合は true。<br>※連想配列は同じkeyの値は上書きになります。 |
| wait | × | 完了を待つ場合は true。デフォルトは false |

## 値について
配列内の値は、全て「文字列」になります。

## format について
※プラグインで用意してあるパターンの場合は、大文字小文字は気にしなくても大丈夫です。
※自分で用意した関数の場合は、大文字小文字は区別します。
### Array
配列  
行に関係なくだらだらと単純に配列にします。  
```[A1,A2,A3,B1,B2,B3,C1,C2,C3,...]```

### ArrayA
配列-配列（多次元配列）  
行ごとに配列になります。  
※format を指定しない場合はこれになります。  
```[[A1,B1,C1],[A2,B2,C3],...]```

### ArrayO
配列-連想配列  
行ごとに、連想配列を入れて行きます。  
1行目がkeyになります（TIPプラグインと同じ）  
```[{A1:A2,B1:B2,C1:C2},{A1:A3,B1:B3,C1:C3},...]```

### Object
連想配列  
1行目に key と value が必須になります。  
その他の項目は、あっても無視されます。  
```{A2:B2,A3:B3,A4:B4,...}```  
※A1=key、B1=value の場合

### ObjectA
連想配列-配列  
1行目に key 必須です。  
```{A2:[B2,C2,D2....],A3:[B3,C3,D3,...],...}```  
※A1=key の場合  
これ、どやって使うのかわからんです・・・  

### ObjectO
連想配列-連想配列  
1行目に key 必須です。  
```{A2:{B1:B2,C1:C2,D1:D2,...},A3:{B1:B3,C1:C3,D1:D3,...},...}```  
※A1=key の場合

## セル内で改行コードを使いたい場合
1. csvファイルの最後のセルに分割用のキー（何でもいいけど本文と被らないように）を入れる。
2. [mc_loadcsv] タグに split属性で、分割用キーを指定する。

## 改行コードを一部変更、一部残したい場合
残したい改行の前に改行コード `\n` を記述してください。
